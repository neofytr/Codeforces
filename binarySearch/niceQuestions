1. https://codeforces.com/edu/course/2/lesson/6/3/practice/contest/285083/problem/D (graphs + binary search)